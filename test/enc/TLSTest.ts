import {fingerprintCertificateDER} from "../../src/enc/Tls";
import {expect} from "chai";

describe('TLS test', () => {
    it('should generate fingerprint', () => {

     var raw = [
      48, 130, 1, 185, 48, 130, 1, 34, 160, 3, 2, 1, 2, 2, 8, 83,
      71, 14, 30, 91, 18, 129, 172, 48, 13, 6, 9, 42, 134, 72, 134,
      247, 13, 1, 1, 11, 5, 0, 48, 29, 49, 27, 48, 25, 6, 3, 85, 4,
      3, 19, 18, 119, 119, 119, 46, 121, 101, 99, 102, 104, 117, 112,
      55, 52, 122, 46, 99, 111, 109, 48, 30, 23, 13, 50, 48, 48, 50,
      49, 48, 48, 52, 48, 52, 52, 53, 90, 23, 13, 50, 49, 48, 50, 48,
      57, 48, 52, 48, 52, 52, 53, 90, 48, 29, 49, 27, 48, 25, 6, 3, 85,
      4, 3, 19, 18, 119, 119, 119, 46, 121, 101, 99, 102, 104, 117, 112,
      55, 52, 122, 46, 99, 111, 109, 48, 129, 159, 48, 13, 6, 9, 42, 134,
      72, 134, 247, 13, 1, 1, 1, 5, 0, 3, 129, 141, 0, 48, 129, 137, 2, 129,
      129, 0, 158, 192, 142, 122, 126, 13, 253, 245, 134, 2, 118, 88, 234, 208,
      202, 182, 199, 6, 138, 202, 214, 239, 184, 159, 172, 237, 193, 5, 132, 161,
      150, 72, 124, 244, 71, 69, 121, 34, 193, 185, 243, 24, 26, 55, 29, 245, 64,
      181, 80, 31, 75, 183, 172, 244, 205, 40, 18, 91, 177, 248, 188, 226, 75, 220,
      122, 89, 206, 179, 252, 139, 161, 64, 192, 53, 138, 179, 158, 233, 136, 64, 73,
      231, 28, 195, 57, 121, 59, 70, 158, 142, 30, 131, 229, 177, 40, 35, 163, 28, 36,
      41, 204, 139, 65, 58, 228, 19, 211, 174, 62, 166, 34, 66, 50, 33, 246, 186, 151,
      183, 39, 156, 161, 166, 64, 53, 253, 84, 124, 149, 2, 3, 1, 0, 1, 163, 2, 48, 0,
      48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 11, 5, 0, 3, 129, 129, 0, 72, 237,
      124, 168, 79, 143, 116, 183, 202, 143, 180, 83, 211, 20, 162, 24, 83, 128, 181, 218,
      5, 173, 255, 74, 205, 63, 105, 225, 136, 64, 178, 201, 141, 16, 200, 153, 250, 126,
      152, 242, 240, 128, 64, 195, 190, 211, 137, 32, 124, 23, 120, 183, 63, 150, 217, 19,
      244, 206, 128, 160, 125, 197, 131, 212, 239, 230, 75, 11, 73, 122, 241, 7, 216, 167,
      19, 215, 209, 101, 223, 21, 161, 42, 175, 124, 45, 215, 102, 161, 32, 16, 78, 208, 183,
      120, 13, 183, 35, 210, 240, 29, 188, 223, 103, 147, 190, 99, 45, 220, 192, 230, 12, 127,
      232, 167, 58, 199, 166, 190, 210, 7, 49, 87, 254, 130, 199, 17, 54, 79];

     var result = [
      63, 35, 41, 188, 224, 184, 196, 89, 15, 58, 178, 105, 143, 114, 235, 39, 4, 73, 102,
      68, 190, 232, 50, 222, 181, 67, 37, 24, 38, 13, 218, 73];


     let fp = fingerprintCertificateDER(Buffer.from(raw), 1024);
     expect(fp).to.eql(Buffer.from(result));
    })
});